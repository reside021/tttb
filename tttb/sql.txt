create table if not exists "__EFMigrationsHistory"
(
    "MigrationId"    varchar(150) not null
        constraint "PK___EFMigrationsHistory"
            primary key,
    "ProductVersion" varchar(32)  not null
);

alter table "__EFMigrationsHistory"
    owner to postgres;

create table if not exists "Surveys"
(
    "Id"          integer generated by default as identity
        constraint "PK_Surveys"
            primary key,
    "Title"       text not null,
    "Description" text not null
);

alter table "Surveys"
    owner to postgres;

create table if not exists "Interviews"
(
    "Id"              integer generated by default as identity
        constraint "PK_Interviews"
            primary key,
    "RespondentName"  text                     not null,
    "RespondentEmail" text                     not null,
    "DateEvent"       timestamp with time zone not null,
    "SurveyId"        integer                  not null
        constraint "FK_Interviews_Surveys_SurveyId"
            references "Surveys"
            on delete cascade
);

alter table "Interviews"
    owner to postgres;

create index if not exists "IX_Interviews_SurveyId"
    on "Interviews" ("SurveyId");

create table if not exists "Questions"
(
    "Id"          integer generated by default as identity
        constraint "PK_Questions"
            primary key,
    "Number"      integer not null,
    "Title"       text    not null,
    "Description" text    not null,
    "SurveyId"    integer
        constraint "FK_Questions_Surveys_SurveyId"
            references "Surveys"
);

alter table "Questions"
    owner to postgres;

create index if not exists "IX_Questions_SurveyId"
    on "Questions" ("SurveyId");

create table if not exists "Answers"
(
    "Id"         integer generated by default as identity
        constraint "PK_Answers"
            primary key,
    "QuestionId" integer not null
        constraint "FK_Answers_Questions_QuestionId"
            references "Questions"
            on delete cascade,
    "Content"    text    not null,
    "IsCorrect"  boolean not null
);

alter table "Answers"
    owner to postgres;

create index if not exists "IX_Answers_QuestionId"
    on "Answers" ("QuestionId");

create table if not exists "Results"
(
    "Id"          integer generated by default as identity
        constraint "PK_Results"
            primary key,
    "InterviewId" integer not null
        constraint "FK_Results_Interviews_InterviewId"
            references "Interviews"
            on delete cascade,
    "QuestionId"  integer not null
        constraint "FK_Results_Questions_QuestionId"
            references "Questions"
            on delete cascade,
    "AnswerId"    integer not null
        constraint "FK_Results_Answers_AnswerId"
            references "Answers"
            on delete cascade
);

alter table "Results"
    owner to postgres;

create index if not exists "IX_Results_AnswerId"
    on "Results" ("AnswerId");

create index if not exists "IX_Results_InterviewId"
    on "Results" ("InterviewId");

create index if not exists "IX_Results_QuestionId"
    on "Results" ("QuestionId");

